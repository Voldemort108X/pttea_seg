<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Progressive Test Time Energy Adaptation for Medical Image Segmentation.">
  <!-- <meta name="keywords" content="Nerfies, D-NeRF, NeRF"> -->
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Progressive Test Time Energy Adaptation for Medical Image Segmentation</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">
  <link rel="icon" href="./static/images/favicon.svg">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>
<body>


<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title">Progressive Test Time Energy Adaptation for Medical Image Segmentation</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://xiaoranzhang.com/">Xiaoran Zhang</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.image.cau.ac.kr/people/director">Byung-Woo Hong</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://vision.cs.yale.edu/members/hyoungseob-park/">Hyoungseob Park</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://www.linkedin.com/in/daniel-pak-0546511a2/">Daniel H. Pak</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://medicine.yale.edu/profile/anne-marie-rickmann/">Anne-Marie Rickmann</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://engineering.yale.edu/research-and-faculty/faculty-directory/lawrence-h-staib">Lawrence H. Staib</a><sup>1</sup>,
            </span>
            <span class="author-block">
              <a href="https://engineering.yale.edu/research-and-faculty/faculty-directory/james-s-duncan">James S. Duncan</a><sup>1*</sup>
            </span>
            <span class="author-block">
              <a href="https://vision.cs.yale.edu/members/alex-wong.html">Alex Wong</a><sup>1*</sup>
            </span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>Yale University,</span>
            <span class="author-block"><sup>2</sup>Chung-Ang University</span>
            <span class="author-block"><sup>*</sup>Joint supervision</span>
          </div>

          <div class="is-size-5 publication-authors">
            <span class="author-block">ICCV 2025</span>
            <span style="color: red; font-weight: bold;"> (Highlight)</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <span class="link-block">
                <a href="https://arxiv.org/abs/2503.16616"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>Preprint</span>
                </a>
              </span>
              <span class="link-block">
                <a href="/assets/ICCV 2025 Poster.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span>Poster</span>
                </a>
              </span>
              <!-- Video Link. -->
              <!-- <span class="link-block">
                <a href="https://www.youtube.com/watch?v=MrKrnHhk8IA"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span> -->
              <!-- Code Link. -->
              <span class="link-block">
                <a href=""
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>
              <!-- Dataset Link. -->
              <!-- <span class="link-block">
                <a href="https://github.com/google/nerfies/releases/tag/0.1"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="far fa-images"></i>
                  </span>
                  <span>Data</span>
                  </a>
            </div> -->

          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Motivation -->
<section class="hero">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="title is-3 has-text-centered">Motivation</h2>
      <div class="columns is-vcentered is-centered" style="margin-bottom: 1.5rem;">
        <div class="column is-half has-text-centered">
          <img src="./assets/motivation.png" alt="Motivation" class="motivation" style="display: block; margin: 0 auto; width: 400px; height: 250px; object-fit: cover;">
        </div>
        <div class="column is-half">
          <ul style="text-align: left; list-style-type: disc; margin-left: 1.5em;"></ul>
            <li>Covariate shifts caused by nuisances such as heteroscedastic noise and inconsistent imaging protocols limit the fidelity of medical image segmentation models.</li>
            <li>Without assuming access to a pre-collected target dataset, which is often impractical, test-time adaptation (TTA) offers a practical solution to calibrate models on-the-fly during inference.</li>
            <li>Assuming a segmentation model is solely trained on source dataset, our goal is to adapt the model to target data without access to the entire target dataset.</li>
          </ul>
        </div>
      </div>
      <div class="content has-text-centered">
      </div>
    </div>
  </div>
</section>

<section class="hero">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="title is-3 has-text-centered">Key components</h2>
      <h2 class="title is-4 has-text-centered">Region-based Shape Energy Model</h2>
      <div class="columns is-vcentered is-centered">
        <div class="column is-half has-text-centered">
          <img src="./assets/teaser.png" alt="Key components" class="motivation" style="display: block; margin: 0 auto 1.5rem auto; width: 350px; height: 250px; object-fit: cover;">
        </div>
        <div class="column is-half">
          <p style="color: red; font-size: 1.2em; font-weight: bold; margin-bottom: 0.5em;">
            Why use energy-based model?
          </p>
          <ul style="text-align: left; list-style-type: disc; margin-left: 1.5em;">
            <li>Energy-based models naturally capture distribution changes by reflecting sample likelihood, making them suited for TTA to quantify distribution misalignments. </li>
            <li>
              We propose a shape energy model trained on source data, which assigns an energy score at the region level:
              <ul style="margin-left: 1em;">
                <li>
                  - Low energy &rarr; ID (accurate) shapes<br>
                  - High energy &rarr; OOD (erroneous) predictions<br>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
      <h2 class="title is-4 has-text-centered">Curate Negative Examples for Energy Model Training</h2>
      <div class="columns is-vcentered is-centered">
        <div class="column is-half has-text-centered">
          <img src="./assets/curated_perturb.png" alt="Key components" class="motivation" style="display: block; margin: 0 auto 1.5rem auto; width: 490px; height: 170px; object-fit: cover;">
        </div>
        <div class="column is-half">
          <p style="color: red; font-size: 1.2em; font-weight: bold; margin-bottom: 0.5em;">
            Impossible to obtain real negative examples (erroneous predictions at inference)?
          </p>
          <ul style="text-align: left; list-style-type: disc; margin-left: 1.5em;">
            <li>Since the input distribution to the energy model is constrained by the predictions afforded by the segmentation model, we propose to explore data space by probing the segmentation model with inputs optimized to simulate OOD examples.</li>
            <!-- <li> Our formulation assumes two collections of examples, one following the desired distribution (of shapes) and the other out-of-distribution (OOD). The .
            </li> -->
          </ul>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Method -->
<section class="hero">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="title is-3 has-text-centered">Method</h2>
      <img src="./assets/main_framework.png" alt="Main Framework" class="main-framework">
      <p style="font-size: 0.95em; color: #555; text-align: left; margin-top: 0.5em; margin-bottom: 1.5em;">
        We assume a segmentation model \( f_\theta(\cdot) \) is pretrained on a source dataset. (a) The energy model \( g_\phi(\cdot) \) is trained to estimate patchwise energy values, using binary reference energy labels based on the mismatch between perturbed predictions \( \hat{Y}_s \) and ground truth shape \( Y_s \) on the source dataset. (b) During adaptation, trained energy model \( g_\phi(\cdot) \) is applied to predictions on test-time distribution, and the BatchNorm layers of \( f_\theta(\cdot) \) are updated iteratively to match with uniform low energy as target.
      </p>
      <!-- MathJax for LaTeX rendering -->
      <script>
        window.MathJax = {
          tex: {
            inlineMath: [['\\(', '\\)']],
            displayMath: [['$$', '$$']]
          },
          svg: {
            fontCache: 'global'
          }
        };
      </script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      <p class="subtitle" style="list-style-type: disc; margin-left: 1.5em;">
        <li><b>Perturbation curation:</b> We generate negative (implausible) examples by applying FGSM adversarial noise and spatial affine transformations to the input images. </li>
        <li><b>Label curation:</b> For each perturbed segmentation, we compare it with ground truth and assign categorical energy labels to each region, where regions dissimilar to the ground truth are labeled as high-energy.</li>
        <li><b>Shape energy model training:</b> A region-based model learns patchwise energy values, assigning high energy to implausible regions and low energy to anatomically valid ones. </li>
        <li><b>Progressive test-time adaptation:</b> At inference, the segmentation model is iteratively updated to minimize the predicted energy, aligning outputs with plausible anatomical shapes.</li>
      </p>
    </div>
  </div>
</section>

<!-- Results -->
<section class="hero">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="title is-3 has-text-centered">Results</h2>
      <div class="content">
        <h2 class="title is-4 has-text-centered">Progressive update visualization</h2>
        <div style="display: flex; align-items: center; justify-content: center;">
          <img src="./assets/acdc_adv_tsne_new.png" style="margin-right: 10px; width: 300px; height: auto;">
          <div style="border-left: 2px dashed black; height: 180px; margin: 0 10px;"></div>
          <img src="./assets/acdc_seg_tsne_new.png"  style="margin-left: 10px; width: 300px; height: auto;">
        </div>
        <p>
          Our adversarial perturbation strategy produces images and segmentations that align with OOD cases, validating its effectiveness in modeling real covariate shifts.
        </p>

        <h2 class="title is-4 has-text-centered">Progressive update visualization</h2>
        <div style="display: flex; align-items: center; justify-content: center;">
          <img src="./assets/tta_demo_web.gif" alt="Looping GIF" style="margin-right: 10px; width: 600px; height: auto;">
          <div style="border-left: 2px dashed black; height: 150px; margin: 0 10px;"></div>
          <img src="./assets/plot_convergence_shortened.png" alt="Quantitative Results" style="margin-left: 10px; width: 250px; height: auto;">
        </div>
        <p>
          Our method progressively refines segmentation quality over iterations (left), while achieving better convergence under the same time budget (right).
        </p>
      </div>
    </div>
  </div>
</section>


<!--Citation-->
<section class="hero">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <h2 class="title is-3 has-text-centered">Citation</h2>
      <div class="content">
      <pre><code>@article{zhang2025progressive,
        title={Progressive Test Time Energy Adaptation for Medical Image Segmentation},
        author={Zhang, Xiaoran and Hong, Byung-Woo and Park, Hyoungseob and Pak, Daniel H and Rickmann, Anne-Marie and Staib, Lawrence H and Duncan, James S and Wong, Alex},
        journal={arXiv preprint arXiv:2503.16616},
        year={2025}
      }
      </code></pre>
      </div>
    </div>
  </div>
</section>


<footer class="footer">
  <div class="container is-max-desktop">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a> which was adopted from the <a href="https://nerfies.github.io" target="_blank">Nerfies</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

</body>
</html>
